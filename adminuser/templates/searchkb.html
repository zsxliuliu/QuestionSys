<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>
            后台管理系统
        </title>
        <meta name="renderer" content="webkit">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="format-detection" content="telephone=no">
        <link rel="stylesheet" href="/static/css/x-admin.css" media="all">
    </head>
    <body>
        <div class="x-nav">
            <span class="layui-breadcrumb">
              <a><cite>首页</cite></a>
              <a><cite>知识库查询</cite></a>
              <a><cite>知识库可视化查询</cite></a>
            </span>
            <a class="layui-btn layui-btn-small" style="line-height:1.6em;margin-top:3px;float:right"  href="javascript:location.replace(location.href);" title="刷新"><i class="layui-icon" style="line-height:30px">ဂ</i></a>
        </div>
        <div class="x-body">
            <form class="layui-form x-center" method="post" action="/adminuser/search" style="width:100%">
                {% csrf_token %}
                <div class="layui-form-pane" style="margin-top: 15px;padding-left:50px;">
                  <div class="layui-form-item" style="width:1100px;">
                    <div class="layui-input-inline" style="width:180px;text-align: left">
                        <select name="entity_type1">
                                    <option  value="{{ entity_type1 }}">{{ entity_type1 }}</option>
                                    {% for entitytype in entitytypes %}
                                        <option  value="{{ entitytype.entity_type }}">{{ entitytype.entity_type }}</option>
                                    {% endfor %}
                                </select>
                    </div>
                    <div class="layui-input-inline" style="width:180px">
                        <input type="text" name="entity_name1"  value="{{ entity1 }}" placeholder="实体1名称" autocomplete="off" class="layui-input">
                    </div>
                      <div class="layui-input-inline" style="width:180px;text-align: left">
                        <select name="relation_type">
                                    <option  value="{{ relation }}">{{ relation }}</option>
                                    <option  value=""></option>
                                    {% for relationtype in relationtypes %}
                                        <option  value="{{ relationtype.relation_type }}">{{ relationtype.relation_type }}</option>
                                    {% endfor %}
                        </select>
                    </div>
                    <div class="layui-input-inline" style="width:180px;text-align: left">
                        <select name="entity_type2">
                                    <option  value="{{ entity_type2 }}">{{ entity_type2 }}</option>
                                    {% for entitytype in entitytypes %}
                                        <option  value="{{ entitytype.entity_type }}">{{ entitytype.entity_type }}</option>
                                    {% endfor %}
                                </select>
                    </div>
                    <div class="layui-input-inline" style="width:180px">
                        <input type="text" name="entity_name2"  value="{{ entity2 }}" placeholder="实体2名称" autocomplete="off" class="layui-input">
                    </div>
                    <div class="layui-input-inline" style="width:80px">
                    <button class="layui-btn"  lay-submit="" lay-filter="sreach"><i class="layui-icon">&#xe615;</i></button>
                    </div>
                  </div>
                </div> 
            </form>
            {% if messages %}
            <script>
                 {% for msg in messages %}
                       alert('{{ msg.message }}');
                 {% endfor %}
            </script>
            {% endif %}
            <div id="neo" style="width:500px;height:300px;"></div>
        </div>
        <script src="/static/lib/layui/layui.js" charset="utf-8"></script>
        <script src="/static/js/x-layui.js" charset="utf-8"></script>
        <script src="http://cdn.bootcss.com/jquery/1.11.2/jquery.min.js"></script>
    <!-- use from online-->
    <script src="https://cdn.bootcss.com/echarts/4.1.0.rc2/echarts.js"></script>
    <!-- use from local-->
    <script src="/static/js/echarts.min.js"></script>
        <script>
            layui.use(['element','layer','form'], function(){
                $ = layui.jquery;//jquery
              lement = layui.element();//面包导航
              layer = layui.layer;//弹出层
              form = layui.form();
            })

            </script>


        <script>
            var data = {{ data|safe }};
    var link = {{ link|safe }};
    alert(data);
    var myChart = echarts.init(document.getElementById('neo'));
    var categories = [];
    for (var i = 0; i < 2; i++) {
        categories[i] = {
            name: '类目' + i
        };
    }
    option = {
        // 图的标题
        title: {
            text: 'ECharts 人物关系图'
        },
        // 提示框的配置
        tooltip: {
            formatter: function (x) {
                return x.data.des;
            }
        },
        // 工具箱
        toolbox: {
            // 显示工具箱
            show: true,
            feature: {
                mark: {
                    show: true
                },
                // 还原
                restore: {
                    show: true
                },
                // 保存为图片
                saveAsImage: {
                    show: true
                }
            }
        },
        legend: [{
            // selectedMode: 'single',
            data: categories.map(function (a) {
                return a.name;
            })
        }],
        series: [{
            type: 'graph',// 类型:关系图
            layout: 'force', //图的布局，类型为力导图
            symbolSize: 40, // 调整节点的大小
            roam: true, // 是否开启鼠标缩放和平移漫游。默认不开启。如果只想要开启缩放或者平移,可以设置成 'scale' 或者 'move'。设置成 true 为都开启
            edgeSymbol: ['circle', 'arrow'],
            edgeSymbolSize: [2, 10],
            edgeLabel: {
                normal: {
                    textStyle: {
                        fontSize: 20
                    }
                }
            },
            force: {
                repulsion: 2500,
                edgeLength: [10, 50]
            },
            draggable: true,

            lineStyle: {
                normal: {
                    width: 2,
                    color: '#4b565b',
                }
            },
            edgeLabel: {
                normal: {
                    show: true,
                    formatter: function (x) {
                        return x.data.name;
                    }
                }
            },
            label: {
                normal: {
                    show: true,
                    textStyle: {},
                    position:'inside'
                }
            },

            // 数据
            data: data,
            links: link,
            categories: categories,
        }]
    };
    myChart.setOption(option);
        </script>
            
    </body>
</html>